# JDBC ‚Äî Batch Processing

---

## 1) What is Batch Processing?

**Batch Processing** in JDBC is a technique to **execute multiple SQL statements as a group (batch)** instead of executing them one by one.

üëâ Advantage:

* **Reduces network calls** between Java and DB
* **Improves performance** for bulk inserts, updates, or deletes

---

## 2) When to Use Batch Processing?

‚úÖ Useful in scenarios like:

* Inserting **thousands of rows** into a table
* Running **bulk updates**
* Applying **multiple DML operations** in one go

‚ùå Not useful for:

* Single queries
* Very small datasets

---

## 3) Steps for Batch Processing

1. Create a `Connection`
2. Disable auto-commit (`conn.setAutoCommit(false)`)
3. Create a `Statement` or `PreparedStatement`
4. Add multiple queries using `addBatch()`
5. Execute batch using `executeBatch()`
6. Commit changes
7. Close resources

---

## 4) Methods Used

| Method                 | Description                                        |
| ---------------------- | -------------------------------------------------- |
| `addBatch(String sql)` | Adds SQL command to the batch (Statement)          |
| `addBatch()`           | Adds command with parameters (PreparedStatement)   |
| `executeBatch()`       | Executes all commands in the batch (returns int[]) |
| `clearBatch()`         | Clears all SQL commands from the batch             |

---

## 5) Example 1: Using Statement (Batch Insert)

```java
import java.sql.*;

class BatchProcessingExample1 {
    public static void main(String[] args) {
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
            Connection conn = DriverManager.getConnection(
                "jdbc:mysql://localhost:3306/testdb", "root", "password");

            Statement stmt = conn.createStatement();

            conn.setAutoCommit(false); // Disable auto-commit

            stmt.addBatch("INSERT INTO students VALUES (101, 'Alice')");
            stmt.addBatch("INSERT INTO students VALUES (102, 'Bob')");
            stmt.addBatch("INSERT INTO students VALUES (103, 'Charlie')");

            int[] result = stmt.executeBatch();  // Execute all at once
            conn.commit();  // Commit manually

            System.out.println("Batch executed. Rows affected: " + result.length);

            stmt.close();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

---

## 6) Example 2: Using PreparedStatement (Efficient)

```java
import java.sql.*;

class BatchProcessingExample2 {
    public static void main(String[] args) {
        try {
            Class.forName("com.mysql.cj.jdbc.Driver");
            Connection conn = DriverManager.getConnection(
                "jdbc:mysql://localhost:3306/testdb", "root", "password");

            String sql = "INSERT INTO students VALUES (?, ?)";
            PreparedStatement pstmt = conn.prepareStatement(sql);

            conn.setAutoCommit(false);

            pstmt.setInt(1, 201);
            pstmt.setString(2, "David");
            pstmt.addBatch();

            pstmt.setInt(1, 202);
            pstmt.setString(2, "Emma");
            pstmt.addBatch();

            pstmt.setInt(1, 203);
            pstmt.setString(2, "Frank");
            pstmt.addBatch();

            int[] result = pstmt.executeBatch();
            conn.commit();

            System.out.println("Batch executed. Rows affected: " + result.length);

            pstmt.close();
            conn.close();
        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

---

## 7) Diagram (Workflow)

```
Java Application
       |
   Connection
       |
Statement / PreparedStatement
       |
  addBatch() [multiple queries]
       |
  executeBatch()
       |
 Database (executes all queries together)
```

---

## 8) Advantages of Batch Processing

‚úî **Performance Boost** ‚Üí fewer DB round-trips
‚úî **Less Code** ‚Üí add queries in a loop
‚úî **Efficient for Bulk Data** (inserts/updates/deletes)

---

## 9) Limitations

* Errors in one query may cause batch failure (depends on DB settings).
* More **memory usage** when adding large batches.
* Best suited for **DML operations** (not SELECT).

---

## 10) Summary Table

| Aspect     | Batch Processing                               |
| ---------- | ---------------------------------------------- |
| Package    | `java.sql`                                     |
| Methods    | `addBatch()`, `executeBatch()`, `clearBatch()` |
| Works with | Statement, PreparedStatement                   |
| Best for   | Bulk Inserts/Updates/Deletes                   |
| Returns    | `int[]` (rows affected for each query)         |
| Advantage  | High performance, fewer network calls          |

---

‚ö° **Key Note for Students**:
üëâ Always use **`PreparedStatement + Batch`** for bulk inserts ‚Üí This is the most **efficient & secure** method.

