

# JDBC ‚Äî PreparedStatement

---

## 1) What is PreparedStatement?

**`PreparedStatement`** is a subinterface of `Statement` (in `java.sql` package).
It is used to execute **parameterized SQL queries** efficiently and securely.

üëâ Unlike `Statement`, SQL is **precompiled** by the database, which makes it:

* **Faster** (compiled once, executed multiple times)
* **Safer** (prevents SQL Injection)
* **Cleaner** (use `?` placeholders instead of string concatenation)

---

## 2) Declaration

```java
PreparedStatement pstmt = conn.prepareStatement("INSERT INTO students VALUES (?, ?)");
```

Here:

* `conn` ‚Üí A valid `Connection` object
* `?` ‚Üí Placeholder for parameters
* `pstmt` ‚Üí A `PreparedStatement` object

---

## 3) Important Methods of PreparedStatement

| Method                                    | Description                                        |
| ----------------------------------------- | -------------------------------------------------- |
| `setInt(int index, int value)`            | Sets an integer parameter                          |
| `setString(int index, String value)`      | Sets a string parameter                            |
| `setDouble(int index, double value)`      | Sets a double parameter                            |
| `setDate(int index, java.sql.Date value)` | Sets a date parameter                              |
| `executeQuery()`                          | Executes SELECT query (returns ResultSet)          |
| `executeUpdate()`                         | Executes INSERT, UPDATE, DELETE, DDL (returns int) |
| `close()`                                 | Closes the PreparedStatement                       |

---

## 4) Example: Using PreparedStatement

```java
import java.sql.*;

class PreparedStatementExample {
    public static void main(String[] args) {
        try {
            // 1. Load Driver
            Class.forName("com.mysql.cj.jdbc.Driver");

            // 2. Establish Connection
            Connection conn = DriverManager.getConnection(
                    "jdbc:mysql://localhost:3306/testdb", "root", "password");

            // 3. Create PreparedStatement
            PreparedStatement pstmt = conn.prepareStatement("INSERT INTO students VALUES (?, ?)");

            // 4. Set parameters
            pstmt.setInt(1, 1);
            pstmt.setString(2, "Alice");

            // 5. Execute
            int rows = pstmt.executeUpdate();
            System.out.println(rows + " row(s) inserted.");

            // 6. Select data
            PreparedStatement pstmt2 = conn.prepareStatement("SELECT * FROM students WHERE id=?");
            pstmt2.setInt(1, 1);
            ResultSet rs = pstmt2.executeQuery();

            while (rs.next()) {
                System.out.println(rs.getInt("id") + " - " + rs.getString("name"));
            }

            // 7. Close
            rs.close();
            pstmt.close();
            pstmt2.close();
            conn.close();

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
}
```

---

## 5) Parameters (Placeholders)

* **`?` (question mark)** ‚Üí Placeholder for values
* Values are set using **setter methods** (`setInt`, `setString`, etc.)
* Index starts from **1 (not 0)**

Example:

```java
PreparedStatement pstmt = conn.prepareStatement("UPDATE students SET name=? WHERE id=?");
pstmt.setString(1, "Bob");
pstmt.setInt(2, 101);
```

---

## 6) Diagram (Workflow)

```
Java Application
       |
   Connection
       |
 PreparedStatement
   |         |
 SQL Query   |
 with ?      |
   |         v
 Parameters Bound
       |
 Execute -> Database
       |
   ResultSet / Update Count
```

---

## 7) Advantages of PreparedStatement

‚úî **Faster** ‚Üí Query is compiled only once.
‚úî **Secure** ‚Üí Prevents SQL Injection.
‚úî **Readable** ‚Üí Parameters are bound, not concatenated.
‚úî **Reusable** ‚Üí Can run the same query multiple times with different values.

---

## 8) When to Use PreparedStatement?

‚úÖ Use when:

* Queries contain **user input**.
* Query is executed **multiple times** with different values.
* Security and performance are important.

‚ùå Avoid when:

* Query is **simple and fixed** ‚Üí `Statement` is enough.

---

## 9) Comparison: Statement vs PreparedStatement

| Feature     | Statement                       | PreparedStatement                            |
| ----------- | ------------------------------- | -------------------------------------------- |
| SQL         | Static                          | Dynamic (with `?`)                           |
| Performance | Slower (compiled every time)    | Faster (compiled once, reused)               |
| Security    | Prone to SQL Injection          | Prevents SQL Injection                       |
| Readability | Messy with string concatenation | Clean (placeholders)                         |
| Reuse       | Must write new query each time  | Same query reused with new parameters        |
| Use case    | Simple, fixed queries           | Queries with input / executed multiple times |

---

## 10) Summary Table

| Aspect      | PreparedStatement                                                   |
| ----------- | ------------------------------------------------------------------- |
| Package     | `java.sql`                                                          |
| Created by  | `Connection.prepareStatement(sql)`                                  |
| Executes    | Parameterized SQL queries                                           |
| Placeholder | `?`                                                                 |
| Methods     | `setInt`, `setString`, `setDouble`, `executeQuery`, `executeUpdate` |
| Returns     | `ResultSet` (for SELECT), `int` (for DML)                           |
| Best for    | Queries with user input, repeated queries                           |
| Advantage   | Faster, secure, reusable                                            |

---
